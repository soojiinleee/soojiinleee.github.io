{"componentChunkName":"component---src-templates-blog-post-js","path":"/sql/sql-syntax-error/","result":{"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"d1430235-0932-599f-af1c-705706f6b424","excerpt":"airflowë¥¼ ì´ìš©í•˜ì—¬ ë§¤ì¼ ìì • ê³µì—° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” DAG ì‘ì„± ì¤‘ ë°œìƒí•œ ì˜¤ë¥˜ Contents ë¬¸ì œ ìƒí™© 1\në¬¸ì œ ìƒí™© 2 ë¬¸ì œ ìƒí™© 1. ë°ì´í„° ë³€í™˜ í›„ SQL bulk insertì„ ìœ„í•´ pythonâ€¦","html":"<p>airflowë¥¼ ì´ìš©í•˜ì—¬ ë§¤ì¼ ìì • ê³µì—° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” DAG ì‘ì„± ì¤‘ ë°œìƒí•œ ì˜¤ë¥˜</p>\n<h1>Contents</h1>\n<p><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9-1.\">ë¬¸ì œ ìƒí™© 1</a><br>\n<a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9-2.\">ë¬¸ì œ ìƒí™© 2</a></p>\n<h1>ë¬¸ì œ ìƒí™© 1.</h1>\n<p>ë°ì´í„° ë³€í™˜ í›„ SQL bulk insertì„ ìœ„í•´ pythonì˜ <code class=\"language-text\">f-string</code>ìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ì„œ ë¬¸ìì—´ê³¼ ë‚ ì§œ ê°’ì„ ëª¨ë‘ ìŒë”°ì˜´í‘œë¡œ ì²˜ë¦¬</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">records <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nrecords<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>\n    <span class=\"token string-interpolation\"><span class=\"token string\">f'(\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>box_office_date<span class=\"token punctuation\">}</span></span><span class=\"token string\">\",</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ranking<span class=\"token punctuation\">}</span></span><span class=\"token string\">,\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_id<span class=\"token punctuation\">}</span></span><span class=\"token string\">\",\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_name<span class=\"token punctuation\">}</span></span><span class=\"token string\">\",\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>genre<span class=\"token punctuation\">}</span></span><span class=\"token string\">\",</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_count<span class=\"token punctuation\">}</span></span><span class=\"token string\">,\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>area<span class=\"token punctuation\">}</span></span><span class=\"token string\">\")'</span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">insert_sql <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"INSERT INTO t VALUES \"</span></span> <span class=\"token operator\">+</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>records<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ë³€í™˜í•œ ë°ì´í„°ë¥¼ redshiftì— ì ì¬í•˜ë‹ˆ ì•„ë˜ ì—ëŸ¬ ë°œìƒ</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token punctuation\">(</span>psycopg2<span class=\"token punctuation\">.</span><span class=\"token keyword\">errors</span><span class=\"token punctuation\">.</span>UndefinedColumn<span class=\"token punctuation\">)</span> <span class=\"token keyword\">column</span> <span class=\"token string\">\"2025-02-01 00:00:00\"</span> does <span class=\"token operator\">not</span> exist <span class=\"token operator\">in</span> box_office</code></pre></div>\n<p>bulk insert ë¬¸ì— ì»¬ëŸ¼ì„ ì ì–´ë„ ê°™ì€ ì—ëŸ¬ ë°œìƒ</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">insert_sql <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"INSERT INTO t (box_office_date,ranking,performance_id,performance_name,genre,performance_count,area) VALUES \"</span></span> <span class=\"token operator\">+</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>records<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- SQL ì‹¤í–‰</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> box_office \n    <span class=\"token punctuation\">(</span>box_office_date<span class=\"token punctuation\">,</span>ranking<span class=\"token punctuation\">,</span>performance_id<span class=\"token punctuation\">,</span>performance_name<span class=\"token punctuation\">,</span>genre<span class=\"token punctuation\">,</span>performance_count<span class=\"token punctuation\">,</span>area<span class=\"token punctuation\">)</span> \n<span class=\"token keyword\">VALUES</span> \n    <span class=\"token punctuation\">(</span><span class=\"token string\">\"2025-02-01 00:00:00\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"PF258148\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ATEEZ WORLD TOUR: TOWARDS THE LIGHT: WILL TO POWER [ì„œìš¸]\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ëŒ€ì¤‘ìŒì•…\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ì„œìš¸\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token string\">\"2025-02-01 00:00:00\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"PF254693\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ì›ƒëŠ” ë‚¨ì\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ë®¤ì§€ì»¬\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ì„œìš¸\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>ì˜¤ë¥˜ ì›ì¸</h2>\n<ul>\n<li>SQL ì¿¼ë¦¬ì—ì„œ <code class=\"language-text\">VALUES</code> ì•ˆì— ë¬¸ìì—´ì´ë‚˜ ë‚ ì§œ ê°’ì— ìŒë”°ì˜´í‘œ(<code class=\"language-text\">\"</code>) ëŒ€ì‹  í™‘ë”°ì˜´í‘œ(<code class=\"language-text\">'</code>)ë¥¼ ì‚¬ìš©</li>\n<li>PostgreSQLì—ì„œëŠ”\n<ul>\n<li><strong>ìŒë”°ì˜´í‘œ</strong>ëŠ” ì»¬ëŸ¼ ë˜ëŠ” ì‹ë³„ìë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš©</li>\n<li><strong>í™‘ë”°ì˜´í‘œ</strong>ë¡œ ë¬¸ìì—´ê³¼ ë‚ ì§œ ê°’ì„ ê°ì‹¸ì•¼ í•¨</li>\n</ul>\n</li>\n</ul>\n<h2>ì˜¤ë¥˜ ìˆ˜ì •</h2>\n<p><code class=\"language-text\">f-string</code> ë¥¼ ìŒë”°ì˜´í‘œë¡œ í•˜ê³  ë¬¸ìì—´ì€ í™‘ë”°ì˜´í‘œë¡œ ì²˜ë¦¬</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">records <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nrecords<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>\n\t<span class=\"token string-interpolation\"><span class=\"token string\">f\"('</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>box_office_date<span class=\"token punctuation\">}</span></span><span class=\"token string\">',</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ranking<span class=\"token punctuation\">}</span></span><span class=\"token string\">,'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_id<span class=\"token punctuation\">}</span></span><span class=\"token string\">','</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_name<span class=\"token punctuation\">}</span></span><span class=\"token string\">','</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>genre<span class=\"token punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>performance_count<span class=\"token punctuation\">}</span></span><span class=\"token string\">,'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>area<span class=\"token punctuation\">}</span></span><span class=\"token string\">')\"</span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h1>ë¬¸ì œ ìƒí™© 2.</h1>\n<p>ë¬¸ì œ ìƒí™©1ì€ í•´ê²° ë˜ì—ˆì§€ë§Œ airflow DAG ì‹¤í–‰ ì‹œ ì‹¤íŒ¨í•˜ëŠ” DAG ë°œìƒ</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">psycopg2<span class=\"token punctuation\">.</span>errors<span class=\"token punctuation\">.</span>SyntaxError<span class=\"token punctuation\">:</span> syntax error at <span class=\"token keyword\">or</span> near <span class=\"token string\">\"t\"</span> <span class=\"token keyword\">in</span> context <span class=\"token string\">\"49,'PF257672','THE SKYSCRAPER: Can't\"</span><span class=\"token punctuation\">,</span> at line <span class=\"token number\">1</span>\nLINE <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2025-01-21'</span><span class=\"token punctuation\">,</span><span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token string\">'PF257672'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'THE SKYSCRAPER: Can'</span>t be blue<span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h2>ì˜¤ë¥˜ ì›ì¸</h2>\n<p>í™‘ë”°ì˜´í‘œê°€ í¬í•¨ëœ ë¬¸ìì—´ì— ëŒ€í•œ ì²˜ë¦¬ê°€ ì—†ì–´ì„œ ìƒê¸´ ì˜¤ë¥˜</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">THE SKYSCRAPER: Can't be blue, PATZ, kimseungjoo</code></pre></div>\n<p>í™‘ë”°ì˜´í‘œ ë‘ ê°œ(<code class=\"language-text\">''</code>)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìì—´ ë‚´ì— í™‘ë”°ì˜´í‘œë¥¼ í¬í•¨</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> box_office \n<span class=\"token keyword\">VALUES</span> \n<span class=\"token punctuation\">(</span><span class=\"token string\">'2025-02-01 00:00:00'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PF123456'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Can''t stop'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ë®¤ì§€ì»¬'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ì„œìš¸'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>ì˜¤ë¥˜ ìˆ˜ì •</h2>\n<p>ë°ì´í„° ë³€í™˜ ì‹œ ë¬¸ìì—´ì— í™‘ë”°ì˜´í‘œê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” python ë¡œì§ ì¶”ê°€</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> <span class=\"token string\">\"'\"</span> <span class=\"token keyword\">in</span> performance_name<span class=\"token punctuation\">:</span> <span class=\"token comment\"># (e.g) Can't be blue</span>\n    performance_name <span class=\"token operator\">=</span> performance_name<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"''\"</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"âœ… sql error - ë”°ì˜´í‘œ","date":"February 04, 2025","description":"APIë¥¼ ì´ìš©í•´ ë°ì´í„° ìˆ˜ì§‘ í›„ DB ì ì¬ ì‹œ ë°œìƒí•œ SQLì˜ ë”°ì˜´í‘œ syntax ì˜¤ë¥˜"}},"previous":{"fields":{"slug":"/book/practices-of-the-python-pro/"},"frontmatter":{"title":"ğŸ“š í”„ë¡œê·¸ë˜ë¨¸ë¥¼ ìœ„í•œ íŒŒì´ì¬"}},"next":{"fields":{"slug":"/django/drf-pagination/"},"frontmatter":{"title":"ğŸ“Œ DRF í†ºì•„ë³´ê¸° - Pagination"}}},"pageContext":{"id":"d1430235-0932-599f-af1c-705706f6b424","previousPostId":"60edd729-ef34-54be-9e9e-471169a06620","nextPostId":"c35c230f-7b77-5573-92d5-3f1446f10511"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}